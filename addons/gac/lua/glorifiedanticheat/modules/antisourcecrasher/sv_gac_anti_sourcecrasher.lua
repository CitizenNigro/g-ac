local
a={a='kicked',b='config'}local
b=hook.Add
local
c=next
local
d=player.GetBySteamID
local
e=require
if(!gAC[a.b].ENABLE_SOURCECRASHER_CHECKS)then
return
end
if(!system.IsLinux())then
return
end

e'slog'
e'sourcenet'local
f='stringcmd_exploit'local
g,h=10000,100
local
i,j={},{}local
function
k(l)local
m=d(l)if
m[a.a]then
return
end
m[a.a]=!!1
gAC.AddDetection(m,"Source Crasher [Code 113]",gAC[a.b].SOURCECRASHER_PUNISHMENT,gAC[a.b].SOURCECRASHER_PUNSIHMENT_BANTIME)if
CNetChan
and
CNetChan(m:EntIndex())then
CNetChan(m:EntIndex()):Shutdown('Source Crasher [Code 113]')end
end
b('ExecuteStringCommand',f,function(l,m)local
n,o=i[l],j[l]if
not
n
then
n=0
end
if
not
o
then
o=0
end
if
n>g
or
o>h
then
k(l)return!!1
end
j[l]=o+1
i[l]=n+#m
end)b('Tick',f,function()for
l,m
in
c,i
do
i[l]=nil
end
for
l,m
in
c,j
do
j[l]=nil
end
end)